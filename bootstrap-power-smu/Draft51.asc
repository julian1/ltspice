Version 4
SHEET 1 2756 1292
WIRE 432 -416 256 -416
WIRE 704 -416 432 -416
WIRE 880 -416 704 -416
WIRE 1024 -416 880 -416
WIRE 1120 -416 1024 -416
WIRE 432 -384 432 -416
WIRE 880 -384 880 -416
WIRE 368 -336 256 -336
WIRE 816 -336 704 -336
WIRE -256 -288 -336 -288
WIRE 432 -288 320 -288
WIRE 880 -288 768 -288
WIRE -336 -272 -336 -288
WIRE 1120 -96 1120 -416
WIRE 1440 -64 1344 -64
WIRE -160 -32 -160 -80
WIRE 704 -16 704 -240
WIRE 784 -16 704 -16
WIRE 1072 -16 784 -16
WIRE 1120 16 1120 0
WIRE 1216 16 1120 16
WIRE 784 48 704 48
WIRE 1120 48 1120 16
WIRE 704 96 704 48
WIRE 784 96 704 96
WIRE 1056 96 784 96
WIRE 784 160 704 160
WIRE -544 208 -624 208
WIRE -416 208 -544 208
WIRE 400 208 -336 208
WIRE 1120 272 1120 144
WIRE 256 304 256 -240
WIRE 256 304 96 304
WIRE -128 352 -160 352
WIRE -16 352 -48 352
WIRE 32 352 -16 352
WIRE 400 352 400 208
WIRE 400 352 320 352
WIRE 432 352 400 352
WIRE 1120 352 496 352
WIRE 1280 352 1120 352
WIRE 1456 352 1280 352
WIRE 1504 352 1456 352
WIRE -16 400 -16 352
WIRE 704 480 704 160
WIRE 1056 480 704 480
WIRE 704 528 704 480
WIRE 784 528 704 528
WIRE 1120 560 1120 528
WIRE 1216 560 1120 560
WIRE 1120 576 1120 560
WIRE 784 592 704 592
WIRE 1072 592 784 592
WIRE 704 704 704 592
WIRE 704 704 624 704
WIRE 544 736 544 704
WIRE -1264 752 -1360 752
WIRE 704 752 704 704
WIRE -160 768 -272 768
WIRE -1360 800 -1360 752
WIRE -1344 800 -1360 800
WIRE 96 800 96 400
WIRE 544 800 96 800
WIRE 640 800 544 800
WIRE -1264 816 -1264 752
WIRE -1264 816 -1280 816
WIRE -1216 816 -1264 816
WIRE -1168 816 -1216 816
WIRE -912 816 -1008 816
WIRE -1344 832 -1408 832
WIRE 800 848 704 848
WIRE -1008 864 -1008 816
WIRE -992 864 -1008 864
WIRE -912 880 -912 816
WIRE -912 880 -928 880
WIRE -800 880 -912 880
WIRE -704 880 -720 880
WIRE -624 880 -640 880
WIRE -992 896 -1168 896
WIRE -624 896 -624 880
WIRE -432 896 -624 896
WIRE -272 896 -272 768
WIRE 96 928 96 880
WIRE 256 928 256 400
WIRE 256 928 96 928
WIRE 704 928 256 928
WIRE 944 928 704 928
WIRE 1120 928 1120 672
WIRE 1120 928 944 928
WIRE -720 976 -720 880
WIRE -704 976 -720 976
WIRE -624 992 -624 896
WIRE -624 992 -640 992
WIRE -352 992 -352 896
WIRE -336 992 -352 992
WIRE -704 1008 -720 1008
WIRE -256 1008 -272 1008
WIRE -144 1008 -256 1008
WIRE -112 1008 -144 1008
WIRE -336 1024 -352 1024
WIRE -1216 1104 -1216 816
WIRE -800 1104 -1216 1104
WIRE -720 1104 -720 1008
WIRE -352 1120 -352 1024
WIRE -336 1120 -352 1120
WIRE -256 1120 -256 1008
WIRE -256 1120 -272 1120
FLAG -160 -32 0
FLAG -336 -368 VCC2
FLAG -336 -192 VEE2
FLAG 944 928 VEE2
FLAG 432 -208 VEE2
FLAG 1024 -416 VCC2
FLAG 880 -208 VEE2
FLAG 1280 352 FCOM
FLAG 1440 -64 FCOM
FLAG -160 352 FCOM
FLAG -960 848 FVCC
FLAG -960 912 FVEE
FLAG -672 960 FVCC
FLAG -672 1024 FVEE
FLAG -640 1104 FCOM
FLAG -144 1008 ERR
FLAG -160 848 FCOM
FLAG -1408 832 VTAP
FLAG -1168 976 LO
FLAG -304 1040 FVCC
FLAG -304 976 FVEE
FLAG -432 1120 FCOM
FLAG -1328 688 0
FLAG -1312 784 FVCC
FLAG -1312 848 FVEE
FLAG 1456 352 VTAP
FLAG -256 -288 LO
FLAG -160 -80 LO
FLAG -544 208 ERR
FLAG 1344 -128 FVCC
FLAG 1216 16 FVCC
FLAG 1344 0 FVEE
FLAG 1216 560 FVEE
FLAG -16 464 0
SYMBOL voltage -336 -384 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 42 41 Left 2
SYMATTR Value 100
SYMATTR InstName V1
SYMBOL voltage -336 -288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 36 39 Left 2
SYMATTR InstName V4
SYMATTR Value 100
SYMBOL npn 1056 48 R0
SYMATTR InstName Q5
SYMATTR Value 2N3904
SYMBOL pnp 1056 528 M180
SYMATTR InstName Q6
SYMATTR Value 2N3906
SYMBOL res 80 784 R0
SYMATTR InstName R9
SYMATTR Value 2k
SYMBOL res 688 832 R0
SYMATTR InstName R16
SYMATTR Value 10R
SYMBOL pnp 32 400 M180
SYMATTR InstName Q4
SYMBOL pnp 320 400 R180
SYMATTR InstName Q7
SYMBOL cap 768 96 R0
SYMATTR InstName C4
SYMATTR Value 1µ
SYMBOL zener 720 160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value BZX84C33VL
SYMBOL npn 640 752 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL pnp 320 -240 R180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL pnp 368 -288 M180
SYMATTR InstName Q3
SYMATTR Value 2N3906
SYMBOL res 240 -432 R0
SYMATTR InstName R3
SYMATTR Value 800R
SYMBOL res 416 -304 R0
SYMATTR InstName R4
SYMATTR Value 200k
SYMBOL pnp 768 -240 R180
SYMATTR InstName Q8
SYMATTR Value 2N3906
SYMBOL pnp 816 -288 M180
SYMATTR InstName Q9
SYMATTR Value 2N3906
SYMBOL res 688 -432 R0
SYMATTR InstName R5
SYMATTR Value 800R
SYMBOL res 864 -304 R0
SYMATTR InstName R6
SYMATTR Value 200k
SYMBOL res 640 688 R90
WINDOW 0 -35 61 VBottom 2
WINDOW 3 -34 51 VTop 2
SYMATTR InstName R7
SYMATTR Value 50R
SYMBOL cap 528 736 R0
WINDOW 0 -53 5 Left 2
WINDOW 3 -54 30 Left 2
SYMATTR InstName C1
SYMATTR Value 20p
SYMBOL res 1104 336 R0
SYMATTR InstName R8
SYMATTR Value 10R
SYMBOL res 1104 256 R0
SYMATTR InstName R10
SYMATTR Value 10R
SYMBOL zener 720 48 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value Z16V
SYMBOL cap 768 -16 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL nmos 1072 -96 R0
SYMATTR InstName M1
SYMATTR Value IRFP240
SYMBOL pmos 1072 672 M180
SYMATTR InstName M2
SYMATTR Value IRFP9240
SYMBOL cap 768 528 R0
SYMATTR InstName C5
SYMATTR Value 1µ
SYMBOL cap 1328 -128 R0
SYMATTR InstName C6
SYMATTR Value 1µ
SYMBOL cap 1328 -64 R0
SYMATTR InstName C7
SYMATTR Value 1µ
SYMBOL zener 720 592 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value Z16V
SYMBOL res -320 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 2k
SYMBOL cap 496 336 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value 100p
SYMBOL res -1184 800 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL res -1184 880 R0
SYMATTR InstName R11
SYMATTR Value 9k
SYMBOL res -704 864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 25k
SYMBOL res -624 864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 25k
SYMBOL res -624 1088 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 25k
SYMBOL res -704 1088 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 25k
SYMBOL voltage -160 752 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -129 -58 Left 2
SYMATTR Value PULSE(2 -5 0 100n 100n 0.2ms 0.4ms 7)
SYMATTR InstName VIN1
SYMBOL OpAmps\\LT1358 -960 816 R0
SYMATTR InstName U1
SYMBOL OpAmps\\LT1358 -672 928 R0
SYMATTR InstName U2
SYMBOL res -336 1136 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 25k
SYMBOL res -256 1136 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R18
SYMATTR Value 25k
SYMBOL res -256 912 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R19
SYMATTR Value 25k
SYMBOL res -336 912 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R20
SYMATTR Value 25k
SYMBOL OpAmps\\LT1358 -304 1072 M180
SYMATTR InstName U3
SYMBOL OpAmps\\LT1358 -1312 752 R0
SYMATTR InstName U4
SYMBOL res -32 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 2k
SYMBOL cap 0 464 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value 100p
TEXT -736 -424 Left 2 !.tran 3ms
TEXT 336 328 Left 2 ;minus
TEXT -16 328 Left 2 ;plus
TEXT 1376 680 Left 2 !.model BZX84C5V1L ako:  BZX84C33VL bv=5.1
TEXT 1384 640 Left 2 !.model BZX84C7V2L ako:  BZX84C33VL bv=7.2
TEXT -176 272 Left 2 ;Much faster. stable with 1k/100p.
TEXT 1376 728 Left 2 !.model BZX84C10V2L ako:  BZX84C33VL bv=10.2
TEXT 1416 120 Left 2 ;Is a traditional op compensation cap sufficient for stability. instead of LP filter?\nNo.\nBut it can be stable with lower values.\neg. 1k/20p
TEXT 352 512 Left 2 ;compensaation
TEXT -728 -360 Left 2 !.ic V(FCOM)=0
TEXT -856 1248 Left 2 ;voltage feedback must be inverted.\nbecause it is now upside down.
TEXT -1440 984 Left 2 ;x20. works
TEXT 1392 576 Left 2 !.model Z19V ako:  BZX84C33VL bv=19
TEXT -896 72 Left 2 ;There is something defining where FCOM should be to gnd.
TEXT 1392 528 Left 2 !.model Z16V ako:  BZX84C33VL bv=16
