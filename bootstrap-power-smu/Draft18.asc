Version 4
SHEET 1 3524 1344
WIRE 544 -656 368 -656
WIRE 1232 -656 544 -656
WIRE 1328 -656 1232 -656
WIRE 368 -624 368 -656
WIRE 544 -576 432 -576
WIRE 480 -528 368 -528
WIRE 1232 -528 1232 -656
WIRE 544 -448 544 -480
WIRE 1008 -448 544 -448
WIRE 1184 -448 1072 -448
WIRE 1232 -384 1232 -432
WIRE 1232 -384 1184 -384
WIRE 1232 -320 1232 -384
WIRE 1328 -320 1296 -320
WIRE 1232 -272 1232 -320
WIRE 544 -192 544 -448
WIRE 1184 -192 544 -192
WIRE 368 -128 368 -528
WIRE 1232 -128 1232 -176
WIRE 1232 -128 1184 -128
WIRE 1232 -96 1232 -128
WIRE 1328 -96 1232 -96
WIRE 1680 -80 1536 -80
WIRE 1744 -80 1680 -80
WIRE 1232 -64 1232 -96
WIRE 1088 -16 992 -16
WIRE 1168 -16 1088 -16
WIRE 1088 32 1088 -16
WIRE 1312 32 1232 32
WIRE 1232 80 1232 32
WIRE 832 128 784 128
WIRE 944 128 896 128
WIRE 992 128 992 -16
WIRE 1088 128 1056 128
WIRE 1232 144 1232 80
WIRE 544 176 544 -192
WIRE 592 176 544 176
WIRE 784 208 784 128
WIRE 800 208 784 208
WIRE 944 224 944 128
WIRE 944 224 864 224
WIRE 976 224 944 224
WIRE 992 224 992 128
WIRE 992 224 976 224
WIRE 1008 224 992 224
WIRE 1088 224 1088 128
WIRE 1232 224 1088 224
WIRE 1408 224 1232 224
WIRE 1424 224 1408 224
WIRE 1504 224 1424 224
WIRE 1568 224 1504 224
WIRE 1712 224 1648 224
WIRE 1728 224 1712 224
WIRE 256 240 80 240
WIRE 544 240 256 240
WIRE 592 240 544 240
WIRE 608 240 592 240
WIRE 800 240 608 240
WIRE 1088 288 1088 224
WIRE 608 304 544 304
WIRE 1232 336 1232 304
WIRE 1424 368 1424 288
WIRE 1232 384 1232 336
WIRE 1312 384 1232 384
WIRE 976 432 976 224
WIRE 1088 432 1088 384
WIRE 1088 432 976 432
WIRE 1168 432 1088 432
WIRE 1744 496 1696 496
WIRE 1232 512 1232 480
WIRE 1328 512 1232 512
WIRE 1232 528 1232 512
WIRE 1232 528 1184 528
WIRE 1776 528 1744 528
WIRE 1232 576 1232 528
WIRE 1744 576 1744 528
WIRE 544 592 544 304
WIRE 1184 592 544 592
WIRE 1808 640 1712 640
WIRE 2912 656 2800 656
WIRE 1712 688 1712 640
WIRE 1728 688 1712 688
WIRE 1808 704 1808 640
WIRE 1808 704 1792 704
WIRE 1856 704 1808 704
WIRE 1904 704 1856 704
WIRE 2160 704 2064 704
WIRE 1232 720 1232 672
WIRE 1344 720 1296 720
WIRE 1728 720 1664 720
WIRE 2064 752 2064 704
WIRE 2080 752 2064 752
WIRE 2160 768 2160 704
WIRE 2160 768 2144 768
WIRE 2272 768 2160 768
WIRE 2368 768 2352 768
WIRE 2448 768 2432 768
WIRE 1232 784 1232 720
WIRE 1232 784 1184 784
WIRE 2080 784 1904 784
WIRE 2448 784 2448 768
WIRE 2640 784 2448 784
WIRE 2800 784 2800 656
WIRE 1232 832 1232 784
WIRE 544 848 544 592
WIRE 1056 848 544 848
WIRE 1184 848 1120 848
WIRE 2352 864 2352 768
WIRE 2368 864 2352 864
WIRE 2448 880 2448 784
WIRE 2448 880 2432 880
WIRE 2720 880 2720 784
WIRE 2736 880 2720 880
WIRE 544 896 544 848
WIRE 2368 896 2352 896
WIRE 2816 896 2800 896
WIRE 2928 896 2816 896
WIRE 2960 896 2960 880
WIRE 2960 896 2928 896
WIRE 2736 912 2720 912
WIRE 368 944 368 -48
WIRE 480 944 368 944
WIRE 544 992 432 992
WIRE 1856 992 1856 704
WIRE 2272 992 1856 992
WIRE 2352 992 2352 896
WIRE 2720 1008 2720 912
WIRE 2736 1008 2720 1008
WIRE 2816 1008 2816 896
WIRE 2816 1008 2800 1008
WIRE 368 1072 368 1040
WIRE 544 1072 368 1072
WIRE 1232 1072 1232 928
WIRE 1232 1072 544 1072
WIRE 1344 1072 1232 1072
FLAG 1328 -96 FVCC
FLAG 1328 512 FVEE
FLAG 1536 -144 FVCC
FLAG 1536 -16 FVEE
FLAG 1408 160 FVCC
FLAG 1424 368 FVEE
FLAG 832 192 FVCC
FLAG 832 256 FVEE
FLAG 1504 224 FCOM
FLAG 2112 736 FVCC
FLAG 2112 800 FVEE
FLAG 1680 -80 FCOM
FLAG 2400 848 FVCC
FLAG 2400 912 FVEE
FLAG 2432 992 FCOM
FLAG 256 240 FCOM
FLAG 2928 896 ERR
FLAG 704 128 ERR
FLAG 2912 736 FCOM
FLAG 1712 224 VTAP
FLAG 1664 720 VTAP
FLAG 1344 992 LO
FLAG 1344 640 LO
FLAG 1328 -240 LO
FLAG 1328 -576 LO
FLAG 1904 864 LO
FLAG 1728 304 LO
FLAG 1776 528 LO
FLAG 736 432 LO
FLAG 2768 928 FVCC
FLAG 2768 864 FVEE
FLAG 2640 1008 FCOM
FLAG 1744 576 0
FLAG 1872 528 FCOM
FLAG 1760 672 FVCC
FLAG 1760 736 FVEE
SYMBOL pnp 480 -480 M180
SYMATTR InstName Q1
SYMATTR Value 2N3906
SYMBOL pnp 432 -528 R180
SYMATTR InstName Q3
SYMATTR Value 2N3906
SYMBOL res 528 -672 R0
SYMATTR InstName R6
SYMATTR Value 800R
SYMBOL voltage 1328 -672 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 42 41 Left 2
SYMATTR Value 200
SYMATTR InstName V1
SYMBOL voltage 1344 976 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 36 39 Left 2
SYMATTR InstName V4
SYMATTR Value 200
SYMBOL res 352 -144 R0
SYMATTR InstName R8
SYMATTR Value 500k
SYMBOL zener 560 240 R180
WINDOW 0 24 64 Left 2
WINDOW 3 56 35 Left 2
SYMATTR InstName D1
SYMATTR Value Z19V
SYMBOL zener 560 304 R180
WINDOW 0 24 64 Left 2
WINDOW 3 54 30 Left 2
SYMATTR InstName D2
SYMATTR Value Z19V
SYMBOL npn 480 896 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL res 528 976 R0
SYMATTR InstName R1
SYMATTR Value 800R
SYMBOL npn 432 944 M0
SYMATTR InstName Q4
SYMATTR Value 2N3904
SYMBOL npn 1168 -64 R0
SYMATTR InstName Q5
SYMATTR Value 2SC5200
SYMBOL pnp 1168 480 M180
WINDOW 3 85 0 Left 2
SYMATTR Value 2SA1943
SYMATTR InstName Q6
SYMBOL res 1216 128 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res 1216 208 R0
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 1104 208 R90
WINDOW 0 81 66 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 500R
SYMBOL nmos 1184 -272 R0
SYMATTR InstName M2
SYMATTR Value IRFP240
SYMBOL pmos 1184 672 M180
SYMATTR InstName M4
SYMATTR Value IRFP9240
SYMBOL cap 576 176 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL cap 592 240 R0
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res 1712 208 R0
SYMATTR InstName R2
SYMATTR Value 10Meg
SYMBOL cap 1520 -144 R0
SYMATTR InstName C7
SYMATTR Value 100n
SYMBOL diode 1424 224 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMBOL diode 1440 288 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D6
SYMBOL diode 1200 -128 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMBOL diode 1200 592 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D8
SYMBOL diode 1296 -336 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D9
SYMBOL voltage 1328 -336 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 42 41 Left 2
SYMATTR Value 36
SYMATTR InstName V2
SYMBOL diode 1232 736 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D10
SYMBOL voltage 1344 624 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 42 41 Left 2
SYMATTR Value 36
SYMATTR InstName V3
SYMBOL nmos 1184 -528 R0
SYMATTR InstName M1
SYMATTR Value IRFP240
SYMBOL diode 1200 -384 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D11
SYMBOL diode 1008 -432 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D12
SYMBOL pmos 1184 928 M180
SYMATTR InstName M3
SYMATTR Value IRFP9240
SYMBOL diode 1200 848 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D13
SYMBOL diode 1120 832 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D14
SYMBOL res 1888 688 R0
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res 1888 768 R0
SYMATTR InstName R9
SYMATTR Value 19k
SYMBOL cap 1520 -80 R0
SYMATTR InstName C9
SYMATTR Value 100n
SYMBOL res 2368 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 25k
SYMBOL res 2448 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 25k
SYMBOL cap 896 112 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -59 31 VTop 2
SYMATTR InstName C8
SYMATTR Value 1n
SYMBOL res 800 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 20k
SYMBOL res 2448 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 25k
SYMBOL res 2368 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 25k
SYMBOL voltage 2912 640 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -129 -58 Left 2
SYMATTR Value PULSE(2 -5 0 100n 100n 0.2ms 0.4ms 7)
SYMATTR InstName VIN1
SYMBOL OpAmps\\LT1358 832 160 R0
SYMATTR InstName U1
SYMBOL OpAmps\\LT1358 2112 704 R0
SYMATTR InstName U2
SYMBOL OpAmps\\LT1358 2400 816 R0
SYMATTR InstName U3
SYMBOL res 1664 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 0.1R
SYMBOL res 2736 1024 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 25k
SYMBOL res 2816 1024 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value 25k
SYMBOL res 2816 800 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R15
SYMATTR Value 25k
SYMBOL res 2736 800 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R16
SYMATTR Value 25k
SYMBOL OpAmps\\LT1358 2768 960 M180
SYMATTR InstName U4
SYMBOL cap 752 432 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C1
SYMATTR Value 10n
SYMBOL OpAmps\\LT1358 1760 640 R0
SYMATTR InstName U5
SYMBOL cap 1056 112 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -59 31 VTop 2
SYMATTR InstName C4
SYMATTR Value 50n
SYMBOL npn 1152 32 M0
SYMATTR InstName Q7
SYMATTR Value 2N3904
SYMBOL res 1248 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 1k
SYMBOL pnp 1152 384 R180
WINDOW 3 85 0 Left 2
SYMATTR Value 2N3906
SYMATTR InstName Q8
SYMBOL res 1248 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1k
TEXT -184 -288 Left 2 !.tran 3ms
TEXT -216 -176 Left 2 !.include my.lib
TEXT -272 -88 Left 2 !.model Z19V ako:  BZX84C33VL bv=19
TEXT -216 -144 Left 2 !.include standard.bjt
TEXT 1504 744 Left 2 ;4W-HI
TEXT 2216 1136 Left 2 ;voltage feedback must be inverted.\nbecause it is now upside down.
TEXT 2200 1232 Left 2 ;and we can add the VSET voltage the same.
TEXT 1632 872 Left 2 ;x20. works
TEXT 1976 80 Left 2 ;The following is stable from 100R to 1Meg. quite nice.\n---\nonly 1k is needed. from 100k to get up to 1G.\n100R -> 10k\n10R -> 1k\n1R -> 100R.\nactually even 100R works up to 1G. not 100k.\n-----\nExtr built in curret limit works how - it also blows off gain.
