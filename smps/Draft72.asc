Version 4
SHEET 1 5720 1740
WIRE 352 -112 352 -176
WIRE 800 -112 800 -176
WIRE 1536 -112 1056 -112
WIRE 1056 -48 1056 -112
WIRE 352 -32 288 -32
WIRE 448 -32 352 -32
WIRE 800 -32 736 -32
WIRE 896 -32 800 -32
WIRE 224 16 224 -32
WIRE 288 16 224 16
WIRE 672 16 672 -32
WIRE 736 16 672 16
WIRE 1376 32 1056 32
WIRE 448 64 352 64
WIRE 800 64 448 64
WIRE 464 384 432 384
WIRE 16 400 -144 400
WIRE 16 432 16 400
WIRE 432 432 432 384
WIRE -896 464 -928 464
WIRE -784 464 -816 464
WIRE 1040 480 976 480
WIRE 1168 496 1120 496
WIRE 160 512 112 512
WIRE 208 512 160 512
WIRE 544 512 544 384
WIRE 544 512 528 512
WIRE 592 512 544 512
WIRE 864 512 784 512
WIRE 880 512 864 512
WIRE 1040 512 880 512
WIRE -448 528 -496 528
WIRE -928 544 -928 464
WIRE -880 544 -928 544
WIRE -320 544 -368 544
WIRE -144 544 -144 400
WIRE -144 544 -320 544
WIRE -784 560 -784 464
WIRE -784 560 -816 560
WIRE -640 560 -784 560
WIRE -448 560 -640 560
WIRE -880 576 -928 576
WIRE 176 576 112 576
WIRE 976 576 976 480
WIRE -928 640 -928 576
WIRE 880 640 880 512
WIRE -496 672 -496 528
WIRE 592 688 592 512
WIRE 736 688 592 688
WIRE -496 736 -496 672
WIRE -928 752 -928 640
WIRE 16 800 16 656
WIRE 432 800 432 656
WIRE 432 800 16 800
WIRE 1168 800 1168 496
WIRE 1168 800 432 800
WIRE 80 1008 48 1008
WIRE 416 1008 272 1008
WIRE 16 1040 16 800
WIRE 80 1040 16 1040
WIRE 304 1072 272 1072
WIRE 496 1072 304 1072
WIRE 48 1232 48 1008
WIRE 304 1232 304 1072
WIRE 304 1232 48 1232
WIRE -240 1248 -320 1248
WIRE -320 1264 -320 1248
WIRE -240 1264 -240 1248
FLAG -240 1264 0
FLAG -320 1168 VCC
FLAG -320 1344 VEE
FLAG 352 144 0
FLAG 1536 -32 0
FLAG 1376 32 0
FLAG -496 1264 0
FLAG -496 1184 P15V
FLAG 352 -256 P15V
FLAG -80 544 0
FLAG 880 736 0
FLAG 784 576 0
FLAG 1056 544 0
FLAG 1072 448 VCC
FLAG 1072 544 VEE
FLAG 1168 416 VCC
FLAG 976 656 0
FLAG 336 512 0
FLAG 336 544 0
FLAG 704 512 VCC
FLAG -80 512 0
FLAG -928 384 0
FLAG -848 528 VCC
FLAG -848 592 VEE
FLAG 864 512 CRAMP
FLAG 448 64 IRAMP
FLAG -1008 576 IRAMP
FLAG 160 512 SW
FLAG -432 592 0
FLAG -416 496 VCC
FLAG -416 592 VEE
FLAG -496 816 0
FLAG -320 464 VCC
FLAG 176 576 CSW
FLAG -640 560 SUMRAMP
FLAG -928 848 0
FLAG -1072 800 CSW
FLAG -1008 640 CRAMP
FLAG -496 672 ISET
FLAG 176 928 VCC
FLAG 176 1152 VCC
FLAG 416 1040 SW
FLAG 496 1104 SW
FLAG 528 1024 SW1
FLAG 608 1088 SW2
FLAG 144 16 SW1
FLAG 800 -256 P15V
FLAG 592 16 SW2
SYMBOL voltage -320 1152 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 5
SYMATTR InstName V2
SYMBOL voltage -320 1248 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 36 39 Left 2
SYMATTR InstName V3
SYMATTR Value 0
SYMBOL 74hc74 16 432 R0
SYMATTR InstName U1
SYMBOL ind2 336 -128 R0
SYMATTR InstName L1
SYMATTR Value 1000µ
SYMATTR Type ind
SYMBOL npn 288 -32 R0
SYMATTR InstName Q1
SYMBOL res 336 48 R0
SYMATTR InstName R1
SYMATTR Value 0.5R
SYMBOL res 240 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 250R
SYMBOL ind2 1040 48 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L3
SYMATTR Value 1000µ
SYMATTR Type ind
SYMBOL res 1520 -128 R0
SYMATTR InstName R5
SYMATTR Value 25R
SYMBOL voltage -496 1168 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 15
SYMATTR InstName V4
SYMBOL res 368 -160 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 0.01R
SYMBOL 74hc74 432 432 R0
SYMATTR InstName U4
SYMBOL res 800 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL cap 768 512 R0
SYMATTR InstName C4
SYMATTR Value 20n
SYMBOL npn 816 640 R0
SYMATTR InstName Q4
SYMBOL res 832 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 100R
SYMBOL Comparators\\LT1011 1072 496 R0
SYMATTR InstName U5
SYMBOL res 1152 400 R0
SYMATTR InstName R12
SYMATTR Value 3.3k
SYMBOL voltage 976 560 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 1V
SYMATTR InstName V6
SYMBOL OpAmps\\LT1006 -848 496 R0
WINDOW 3 30 120 Left 2
SYMATTR InstName U3
SYMBOL res -912 480 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res -800 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res -1024 592 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 85 57 VBottom 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -1024 656 R270
WINDOW 0 -32 55 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL Comparators\\LT1011 -416 544 R0
SYMATTR InstName U6
SYMBOL res -336 448 R0
SYMATTR InstName R14
SYMATTR Value 3.3k
SYMBOL voltage -496 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 1V
SYMATTR InstName V5
SYMBOL res 560 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL npn -992 752 R0
SYMATTR InstName Q3
SYMBOL res -976 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 5k
SYMBOL 74hc74 176 928 R0
SYMATTR InstName U2
SYMBOL 74hc08 464 960 R0
SYMATTR InstName U7
SYMBOL 74hc08 544 1024 R0
SYMATTR InstName U8
SYMBOL ind2 816 -16 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 1000µ
SYMATTR Type ind
SYMBOL npn 736 -32 R0
SYMATTR InstName Q2
SYMBOL res 688 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 250R
SYMBOL res 816 -160 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 0.01R
SYMBOL cap 288 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1p
SYMBOL cap 736 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1p
TEXT -168 -224 Left 2 !.tran 0.5ms
TEXT -208 -312 Left 2 !.include 74hc.lib
TEXT 1024 -456 Left 2 !K L1 L2 L3 0.99
TEXT 1432 344 Left 2 ;current mode control,  with slope compensation to support duty cycle > 50%.\nIset controls power\n \nSlope compensation is implemented by summing the cycle periodic ramp \nwith the sensed current signal.\n \nfail case, if iset is too high (ie. exceed cramp) then do not get switch off cross\nevent. need clamp.  OR second safety current trip point comparator that can fire \nanytime in the cycle, to protect bjt/fet switch.\n \nflyback needs snubber, voltage regulation feedback loop.\nforward converter, needs reset winding, and boost topology secondary.\npush pull,  would mux the bjt to turn on,  with another flipflop/and gate\n \nIn a push pull the extra complementary magnetic winding, will work for the reset/snubber.\nOr the output windings will, with a non blocking rectifier.
