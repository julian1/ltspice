Version 4
SHEET 1 5720 1380
WIRE 272 -64 112 -64
WIRE 272 -32 272 -64
WIRE 1456 -16 976 -16
WIRE 416 48 368 48
WIRE 464 48 416 48
WIRE 976 48 976 -16
WIRE -592 80 -624 80
WIRE -480 80 -512 80
WIRE 432 112 368 112
WIRE 1296 128 1296 48
WIRE 1296 128 976 128
WIRE -144 144 -192 144
WIRE -624 160 -624 80
WIRE -576 160 -624 160
WIRE -16 160 -64 160
WIRE 112 160 112 -64
WIRE 112 160 -16 160
WIRE -480 176 -480 80
WIRE -480 176 -512 176
WIRE -336 176 -480 176
WIRE -144 176 -336 176
WIRE -576 192 -624 192
WIRE -624 256 -624 192
WIRE -192 288 -192 144
WIRE -192 352 -192 288
WIRE -624 368 -624 256
WIRE 464 384 432 384
WIRE 432 432 432 384
WIRE 1040 480 976 480
WIRE 1168 496 1120 496
WIRE 544 512 544 384
WIRE 544 512 528 512
WIRE 592 512 544 512
WIRE 864 512 784 512
WIRE 880 512 864 512
WIRE 1040 512 880 512
WIRE 976 576 976 480
WIRE 880 640 880 512
WIRE 592 688 592 512
WIRE 736 688 592 688
WIRE -432 800 -512 800
WIRE 272 800 272 192
WIRE 432 800 432 656
WIRE 432 800 272 800
WIRE 1168 800 1168 496
WIRE 1168 800 432 800
WIRE -512 816 -512 800
WIRE -432 816 -432 800
WIRE 336 1008 304 1008
WIRE 672 1008 528 1008
WIRE 272 1040 272 800
WIRE 336 1040 272 1040
WIRE 560 1072 528 1072
WIRE 752 1072 560 1072
WIRE 1216 1104 1216 1040
WIRE 1664 1104 1664 1040
WIRE 1312 1184 1216 1184
WIRE 1760 1184 1664 1184
WIRE 304 1232 304 1008
WIRE 560 1232 560 1072
WIRE 560 1232 304 1232
WIRE 1152 1232 1088 1232
WIRE 1600 1232 1536 1232
WIRE 1312 1280 1216 1280
WIRE 1664 1280 1312 1280
FLAG -432 816 0
FLAG -512 720 VCC
FLAG -512 896 VEE
FLAG 1216 1360 0
FLAG 1456 64 0
FLAG 1296 128 0
FLAG -688 816 0
FLAG -688 736 P15V
FLAG 1216 960 P15V
FLAG 176 80 0
FLAG 880 736 0
FLAG 784 576 0
FLAG 1056 544 0
FLAG 1072 448 VCC
FLAG 1072 544 VEE
FLAG 1168 416 VCC
FLAG 976 656 0
FLAG 336 512 0
FLAG 336 544 0
FLAG 704 512 VCC
FLAG 176 48 0
FLAG -624 0 0
FLAG -544 144 VCC
FLAG -544 208 VEE
FLAG 864 512 CRAMP
FLAG 1312 1280 IRAMP
FLAG -704 192 IRAMP
FLAG 416 48 SW
FLAG -128 208 0
FLAG -112 112 VCC
FLAG -112 208 VEE
FLAG -192 432 0
FLAG -16 80 VCC
FLAG 432 112 CSW
FLAG -336 176 SUMRAMP
FLAG -624 464 0
FLAG -768 416 CSW
FLAG -704 256 CRAMP
FLAG -192 288 ISET
FLAG 432 928 VCC
FLAG 432 1152 VCC
FLAG 672 1040 SW
FLAG 752 1104 SW
FLAG 784 1024 SW1
FLAG 864 1088 SW2
FLAG 1008 1232 SW1
FLAG 1664 960 P15V
FLAG 1456 1232 SW2
SYMBOL voltage -512 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 5
SYMATTR InstName V2
SYMBOL voltage -512 800 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 36 39 Left 2
SYMATTR InstName V3
SYMATTR Value 0
SYMBOL 74hc74 272 -32 R0
SYMATTR InstName U1
SYMBOL ind2 1200 1088 R0
SYMATTR InstName L1
SYMATTR Value 800µ
SYMATTR Type ind
SYMBOL npn 1152 1184 R0
SYMATTR InstName Q1
SYMBOL res 1200 1264 R0
SYMATTR InstName R1
SYMATTR Value 0.5R
SYMBOL res 1104 1216 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 250R
SYMBOL ind2 960 144 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L3
SYMATTR Value 800µ
SYMATTR Type ind
SYMBOL res 1440 -32 R0
SYMATTR InstName R5
SYMATTR Value 50R
SYMBOL voltage -688 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 15
SYMATTR InstName V4
SYMBOL res 1232 1056 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 0.01R
SYMBOL 74hc74 432 432 R0
SYMATTR InstName U4
SYMBOL res 800 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL cap 768 512 R0
SYMATTR InstName C4
SYMATTR Value 20n
SYMBOL npn 816 640 R0
SYMATTR InstName Q4
SYMBOL res 832 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 100R
SYMBOL Comparators\\LT1011 1072 496 R0
SYMATTR InstName U5
SYMBOL res 1152 400 R0
SYMATTR InstName R12
SYMATTR Value 3.3k
SYMBOL voltage 976 560 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 1V
SYMATTR InstName V6
SYMBOL OpAmps\\LT1006 -544 112 R0
WINDOW 3 30 120 Left 2
SYMATTR InstName U3
SYMBOL res -608 96 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res -496 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res -720 208 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 85 57 VBottom 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -720 272 R270
WINDOW 0 -32 55 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL Comparators\\LT1011 -112 160 R0
SYMATTR InstName U6
SYMBOL res -32 64 R0
SYMATTR InstName R14
SYMATTR Value 3.3k
SYMBOL voltage -192 336 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 1V
SYMATTR InstName V5
SYMBOL res 560 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL npn -688 368 R0
SYMATTR InstName Q3
SYMBOL res -672 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 5k
SYMBOL 74hc74 432 928 R0
SYMATTR InstName U2
SYMBOL 74hc08 720 960 R0
SYMATTR InstName U7
SYMBOL 74hc08 800 1024 R0
SYMATTR InstName U8
SYMBOL ind2 1680 1200 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 800µ
SYMATTR Type ind
SYMBOL npn 1600 1184 R0
SYMATTR InstName Q2
SYMBOL res 1552 1216 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 250R
SYMBOL res 1680 1056 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 0.01R
TEXT -168 -224 Left 2 !.tran 0.5ms
TEXT -208 -312 Left 2 !.include 74hc.lib
TEXT 944 -360 Left 2 !K L1 L2 L3 0.99
TEXT 1432 344 Left 2 ;current mode control,  with slope compensation to support duty cycle > 50%.\nIset controls power\n \nSlope compensation is implemented by summing the cycle periodic ramp \nwith the sensed current signal.\n \nfail case, if iset is too high (ie. exceed cramp) then do not get switch off cross\nevent. need clamp.  OR second safety current trip point comparator that can fire \nanytime in the cycle, to protect bjt/fet switch.\n \nflyback needs snubber, voltage regulation feedback loop.\nforward converter, needs reset winding, and boost topology secondary.\npush pull,  would mux the bjt to turn on,  with another flipflop/and gate\n \nIn a push pull the extra complementary magnetic winding, will work for the reset/snubber.\nOr the output windings will, with a non blocking rectifier.
