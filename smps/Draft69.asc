Version 4
SHEET 1 5720 1268
WIRE 1552 -256 1392 -256
WIRE 1552 -176 1392 -176
WIRE 640 0 544 0
WIRE 944 0 944 -128
WIRE 944 0 704 0
WIRE 1120 0 1104 0
WIRE 944 64 944 0
WIRE 272 96 176 96
WIRE 464 96 272 96
WIRE 544 96 544 0
WIRE 560 96 544 96
WIRE 784 112 624 112
WIRE 880 112 864 112
WIRE 464 128 384 128
WIRE 560 128 544 128
WIRE 1184 160 944 160
WIRE 1264 176 1248 176
WIRE 1376 176 1264 176
WIRE 1184 192 1168 192
WIRE 1168 272 1168 192
WIRE 1264 272 1264 176
WIRE 1264 272 1248 272
WIRE 544 320 544 128
WIRE -208 384 -288 384
WIRE -288 400 -288 384
WIRE -208 400 -208 384
FLAG -208 400 0
FLAG -288 304 VCC
FLAG -288 480 VEE
FLAG -464 400 0
FLAG -464 320 P15V
FLAG 176 176 0
FLAG 272 96 DRIVE
FLAG 592 144 VCC
FLAG 592 80 VEE
FLAG 384 208 0
FLAG 944 -288 VCC
FLAG 944 240 0
FLAG 1216 208 VCC
FLAG 1216 144 VEE
FLAG 1168 352 0
SYMBOL voltage -288 288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 5
SYMATTR InstName V2
SYMBOL voltage -288 384 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 36 39 Left 2
SYMATTR InstName V3
SYMATTR Value 0
SYMBOL voltage -464 304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 15
SYMATTR InstName V4
SYMBOL voltage 176 80 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -545 49 Left 2
SYMATTR Value PULSE(2 3 1us 10ns 10ns 25us 50us 7)
SYMATTR InstName V1
SYMBOL voltage 384 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -78 78 Left 2
WINDOW 0 -77 54 Left 2
SYMATTR Value 2.5
SYMATTR InstName V7
SYMBOL res 560 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -49 62 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL OpAmps\\LT1006 592 176 M180
SYMATTR InstName U1
SYMBOL cap 704 -16 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -53 31 VTop 2
SYMATTR InstName C3
SYMATTR Value 0.3n
SYMBOL npn 880 64 R0
SYMATTR InstName Q1
SYMBOL res 880 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 250R
SYMBOL res 928 -304 R0
SYMATTR InstName R4
SYMATTR Value 50R
SYMBOL res 928 144 R0
SYMATTR InstName R5
SYMATTR Value 1R
SYMBOL ind2 928 -224 R0
SYMATTR InstName L1
SYMATTR Value 1000µ
SYMATTR Type ind
SYMBOL ind2 1376 -272 R0
SYMATTR InstName L2
SYMATTR Value 1000µ
SYMATTR Type ind
SYMBOL res 1568 -160 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 50R
SYMBOL res 1264 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 20k
SYMBOL res 1184 368 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL OpAmps\\LT1677 1216 240 M180
SYMATTR InstName U2
SYMBOL res 560 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -49 62 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
TEXT -88 -224 Left 2 !.tran 0.5ms
TEXT 1216 -320 Left 2 !K L1 L2 0.99
TEXT 1112 -592 Left 2 ;Ok. this works. the cap (C3) is the integrator, driven direct off collector.\nthe op drives the bjt however it has to, to match the input current (R15).\n \ninput resistor (R15) and input voltage determines slew.\n \ncan change the inductor load (R6) , and slew renames the same\neven though current will increase through inductor due to coupling.\n \nadding bypass cap, creates more instability.
TEXT 1504 -32 Left 2 ;issue - is combining is additive, rather than thresholding.\nthe current limit doesn't seem to work. higher C, makes steeper.\nBut it doesn't matter much, control slewing the collector, also controls\nslew on current rate on current sense.\nBecause it's a common emitter\nAnd the inductor limits current slew - even at switch on/off, and for both bjts.
