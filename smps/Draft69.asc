Version 4
SHEET 1 5720 1268
WIRE 1552 -256 1392 -256
WIRE 1552 -176 1392 -176
WIRE 640 0 544 0
WIRE 944 0 944 -128
WIRE 944 0 704 0
WIRE 944 64 944 0
WIRE 544 96 544 0
WIRE 560 96 544 96
WIRE 688 112 624 112
WIRE 880 112 768 112
WIRE 560 128 480 128
WIRE 1296 128 1296 64
WIRE 1312 128 1296 128
WIRE 1392 144 1376 144
WIRE 1136 160 944 160
WIRE 1264 160 1264 96
WIRE 1264 160 1200 160
WIRE 1312 160 1264 160
WIRE 224 256 160 256
WIRE 1072 336 880 336
WIRE 1392 336 1392 144
WIRE 1392 336 1152 336
WIRE 160 368 64 368
WIRE -208 384 -288 384
WIRE 160 384 160 368
WIRE -288 400 -288 384
WIRE -208 400 -208 384
FLAG -208 400 0
FLAG -288 304 VCC
FLAG -288 480 VEE
FLAG -464 400 0
FLAG -464 320 P15V
FLAG 112 160 0
FLAG 464 96 DRIVE
FLAG 592 144 VCC
FLAG 592 80 VEE
FLAG 944 -288 VCC
FLAG 944 240 0
FLAG 1344 176 VCC
FLAG 1344 112 VEE
FLAG 1184 96 CDRIVE
FLAG 320 400 0
FLAG 320 320 LP0V5
FLAG 1296 64 LP0V5
FLAG 480 128 LP0V5
FLAG 112 80 DRIVE
FLAG 48 256 DRIVE
FLAG -48 368 DRIVE
SYMBOL voltage -288 288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 5
SYMATTR InstName V2
SYMBOL voltage -288 384 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 36 39 Left 2
SYMATTR InstName V3
SYMATTR Value 0
SYMBOL voltage -464 304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 15
SYMATTR InstName V4
SYMBOL voltage 112 64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -545 49 Left 2
SYMATTR Value PULSE(0 1 1us 10ns 10ns 25us 50us 7)
SYMATTR InstName V1
SYMBOL res 560 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -60 57 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL OpAmps\\LT1006 592 176 M180
SYMATTR InstName U1
SYMBOL npn 880 64 R0
SYMATTR InstName Q1
SYMBOL res 784 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 250R
SYMBOL res 928 -304 R0
SYMATTR InstName R4
SYMATTR Value 0.01R
SYMBOL res 928 144 R0
SYMATTR InstName R5
SYMATTR Value 1R
SYMBOL ind2 928 -224 R0
SYMATTR InstName L1
SYMATTR Value 1000µ
SYMATTR Type ind
SYMBOL ind2 1376 -272 R0
SYMATTR InstName L2
SYMATTR Value 1000µ
SYMATTR Type ind
SYMBOL res 1568 -160 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 50R
SYMBOL OpAmps\\LT1677 1344 208 M180
SYMATTR InstName U2
SYMBOL res 1168 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 500R
SYMBOL cap 1200 144 R90
WINDOW 0 87 64 VBottom 2
WINDOW 3 31 60 VTop 2
SYMATTR InstName C1
SYMATTR Value 0.3n
SYMBOL voltage 320 304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -78 78 Left 2
WINDOW 0 -77 54 Left 2
SYMATTR Value 0.5
SYMATTR InstName V5
SYMBOL cap 704 -16 R90
WINDOW 0 87 64 VBottom 2
WINDOW 3 31 60 VTop 2
SYMATTR InstName C2
SYMATTR Value 0.3n
SYMBOL res 1280 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -57 57 VTop 2
SYMATTR InstName R9
SYMATTR Value 200k
SYMBOL 74hc04 96 192 R0
SYMATTR InstName U3
SYMBOL 74hc14 0 320 R0
SYMATTR InstName U4
TEXT -88 -224 Left 2 !.tran 0.5ms
TEXT 1216 -320 Left 2 !K L1 L2 0.99
TEXT 1112 -592 Left 2 ;Ok. this works. the cap (C3) is the integrator, driven direct off collector.\nthe op drives the bjt however it has to, to match the input current (R15).\n \ninput resistor (R15) and input voltage determines slew.\n \ncan change the inductor load (R6) , and slew renames the same\neven though current will increase through inductor due to coupling.\n \nadding bypass cap, creates more instability.
TEXT 1600 -96 Left 2 ;This works, can either slew collector voltage, or current.\nBut not both at the same time\nneeds a thresholding/ ideal diode like mux.\nThe response is inverse.
TEXT -96 -160 Left 2 !.include 74hc.lib
