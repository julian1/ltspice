Version 4
SHEET 1 3820 1268
WIRE 944 -576 896 -576
WIRE 2320 -560 2256 -560
WIRE 2528 -560 2320 -560
WIRE 2656 -560 2608 -560
WIRE 2736 -560 2656 -560
WIRE 896 -544 896 -576
WIRE 944 -544 896 -544
WIRE 1216 -544 1216 -576
WIRE 944 -512 896 -512
WIRE 1424 -496 1424 -560
WIRE 1872 -496 1872 -560
WIRE 2256 -496 2080 -496
WIRE 2352 -496 2320 -496
WIRE 896 -480 896 -512
WIRE 944 -480 896 -480
WIRE 1216 -480 1216 -512
WIRE 2320 -432 2256 -432
WIRE 2656 -432 2656 -496
WIRE 2656 -432 2320 -432
WIRE 2736 -432 2736 -480
WIRE 2736 -432 2656 -432
WIRE 1424 -416 1360 -416
WIRE 1520 -416 1424 -416
WIRE 1872 -416 1808 -416
WIRE 1968 -416 1872 -416
WIRE 2352 -416 2352 -496
WIRE 2352 -416 2080 -416
WIRE 672 -368 656 -368
WIRE 896 -368 864 -368
WIRE 1296 -368 1296 -416
WIRE 1360 -368 1296 -368
WIRE 1744 -368 1744 -416
WIRE 1744 -368 1664 -368
WIRE 1808 -368 1744 -368
WIRE 672 -336 592 -336
WIRE 1520 -320 1424 -320
WIRE 1872 -320 1520 -320
WIRE 896 -304 864 -304
WIRE 656 -160 656 -368
WIRE 896 -160 896 -304
WIRE 896 -160 656 -160
WIRE 592 -112 592 -336
WIRE 592 -112 560 -112
WIRE 480 -64 480 -112
WIRE 112 16 32 16
WIRE 592 16 592 -112
WIRE 592 16 576 16
WIRE 640 16 592 16
WIRE 928 16 832 16
WIRE 1056 16 928 16
WIRE 32 32 32 16
WIRE 112 32 112 16
WIRE 928 144 928 16
WIRE 640 192 640 16
WIRE 784 192 640 192
WIRE 480 304 480 160
WIRE 1056 304 1056 16
WIRE 1056 304 480 304
FLAG 112 32 0
FLAG 32 -64 VCC
FLAG 32 112 VEE
FLAG -144 32 0
FLAG -144 -48 P15V
FLAG 928 240 0
FLAG 832 80 0
FLAG 384 16 0
FLAG 384 48 0
FLAG 752 16 VCC
FLAG 768 -448 VCC
FLAG 768 -224 VCC
FLAG 896 -368 SW1
FLAG 896 -304 SW2
FLAG 1424 -240 0
FLAG 1424 -640 P15V
FLAG 1520 -320 IRAMP
FLAG 1296 -368 SW1_
FLAG 1872 -640 P15V
FLAG 1664 -368 SW2_
FLAG 2736 -432 0
FLAG 896 -576 SW1
FLAG 896 -512 SW2
FLAG 1216 -576 SW1_
FLAG 1216 -480 SW2_
FLAG 944 -640 0
SYMBOL voltage 32 -80 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 5
SYMATTR InstName V2
SYMBOL voltage 32 16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 36 39 Left 2
SYMATTR InstName V3
SYMATTR Value 0
SYMBOL 74hc74 768 -448 R0
SYMATTR InstName U1
SYMBOL voltage -144 -64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 15
SYMATTR InstName V4
SYMBOL 74hc74 480 -64 R0
SYMATTR InstName U4
SYMBOL res 848 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 3.0k
SYMBOL cap 816 16 R0
SYMATTR InstName C4
SYMATTR Value 5n
SYMBOL npn 864 144 R0
SYMATTR InstName Q4
SYMBOL res 880 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 100R
SYMBOL res 576 -128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL ind2 1408 -512 R0
SYMATTR InstName L1
SYMATTR Value 100µ
SYMATTR Type ind
SYMBOL npn 1360 -416 R0
SYMATTR InstName Q1
SYMATTR Value FJL4315
SYMBOL res 1408 -336 R0
SYMATTR InstName R2
SYMATTR Value 0.2R
SYMBOL ind2 2064 -400 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 5000µ
SYMATTR Type ind
SYMBOL res 1440 -544 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R4
SYMATTR Value 0.01R
SYMBOL ind2 1888 -400 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L3
SYMATTR Value 100µ
SYMATTR Type ind
SYMBOL npn 1808 -416 R0
SYMATTR InstName Q2
SYMATTR Value FJL4315
SYMBOL res 1888 -544 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 0.01R
SYMBOL diode 2272 -496 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL diode 2336 -496 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMBOL diode 2272 -432 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMBOL diode 2336 -432 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMBOL cap 2640 -560 R0
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL res 2720 -576 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL ind2 2512 -544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value 1000µ
SYMATTR Type ind
SYMBOL 74hc244 1040 -704 R0
SYMATTR InstName U2
SYMBOL res 1232 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100R
SYMBOL res 1232 -528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 100R
SYMBOL res 1232 -560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100R
SYMBOL res 1232 -592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 100R
TEXT 136 -288 Left 2 !.tran 1.2ms
TEXT 96 -376 Left 2 !.include 74hc.lib
TEXT -328 352 Left 2 ;Having RC charged by VCC. guarantees a cold-start pulse.\n- we get clearly defined phases\n- start pulse.\n- finish of current ramp .\n- finish cycle. fixed timing.
TEXT 1504 -168 Left 2 ;Use 10k and gate capacitance, to slow the reset timing.\n \n74hc74 pinout appears the same as 74hc74d.\n \ninputs are considered active lo.\nCLR/ RD (pin 1) hi, turns Q hi. CLR dominates.  (reset as active low)\nPRE / SD  (pin 4 ) hi, turns Q lo. ~Q high.
TEXT 1904 -872 Left 2 !K L1 L2 L3 0.99
TEXT 2928 -624 Left 2 ;OKK. strange we got rid of the output inductor. and current still ramps nicely.\nAlso no inductive spike on the collectors with real BJT.\n \n100kHz\n \n50V/50mA.  1k.  15V * Math.sqrt( 1000) / Math.sqrt(100) = 47\n \n100V/50mA 1k load. 15 * Math.sqrt( 1000) / Math.sqrt(22) = 101\n \n100V/100mA.  with 100R bjt drive.
TEXT 96 -440 Left 2 !.include standard.bjt
