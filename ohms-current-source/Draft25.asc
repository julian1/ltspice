Version 4
SHEET 1 2456 980
WIRE -64 16 -64 -48
WIRE 48 16 -64 16
WIRE 192 16 128 16
WIRE 320 16 192 16
WIRE 512 16 400 16
WIRE 1216 32 720 32
WIRE 720 64 720 32
WIRE 192 80 192 16
WIRE 224 80 192 80
WIRE 512 80 512 16
WIRE 336 96 288 96
WIRE 464 96 416 96
WIRE -64 112 -64 96
WIRE 224 112 -64 112
WIRE 1216 112 896 112
WIRE -64 128 -64 112
WIRE 1904 144 1904 112
WIRE -352 176 -384 176
WIRE 896 176 896 112
WIRE 928 176 896 176
WIRE 1216 176 1216 112
WIRE -240 192 -288 192
WIRE -112 192 -160 192
WIRE 1040 192 992 192
WIRE 1168 192 1120 192
WIRE -352 208 -544 208
WIRE 512 208 512 176
WIRE 928 208 896 208
WIRE -544 224 -544 208
WIRE 1616 240 1584 240
WIRE 1904 240 1904 208
WIRE 1728 256 1680 256
WIRE 1856 256 1808 256
WIRE 1616 272 1216 272
WIRE 512 288 512 272
WIRE -384 304 -384 176
WIRE -64 304 -64 208
WIRE -64 304 -384 304
WIRE 1856 320 1856 256
WIRE 1216 416 1216 352
WIRE 1440 416 1216 416
WIRE 1584 416 1584 240
WIRE 1584 416 1520 416
WIRE 1712 416 1584 416
WIRE 1904 416 1904 336
WIRE 1904 416 1792 416
WIRE 1216 480 1216 416
WIRE 112 752 0 752
FLAG 112 752 0
FLAG 0 832 VEE2
FLAG 0 672 VCC2
FLAG 256 128 VEE2
FLAG 256 64 VCC2
FLAG -320 224 VEE2
FLAG -320 160 VCC2
FLAG -544 304 0
FLAG -64 384 0
FLAG -64 -48 VCC2
FLAG 512 368 0
FLAG 1648 288 VEE2
FLAG 1648 224 VCC2
FLAG 960 224 VEE2
FLAG 960 160 VCC2
FLAG 720 144 0
FLAG 1904 32 0
FLAG 1216 480 VEE2
FLAG 896 208 0
SYMBOL voltage 0 736 R0
WINDOW 0 54 29 Left 2
WINDOW 3 50 56 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL res 496 272 R0
SYMATTR InstName RDUT
SYMATTR Value 1k
SYMBOL res 144 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName ISET
SYMATTR Value 5k
SYMBOL pmos 464 176 M180
SYMATTR InstName M1
SYMBOL voltage 0 656 R0
WINDOW 0 54 29 Left 2
WINDOW 3 50 56 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL res 432 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 416 0 R90
WINDOW 0 -33 56 VBottom 2
WINDOW 3 -27 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL OpAmps\\ADA4625 256 32 R0
WINDOW 3 -165 146 Left 2
SYMATTR InstName U2
SYMBOL diode 496 208 R0
SYMATTR InstName D1
SYMBOL res -80 288 R0
SYMATTR InstName R5
SYMATTR Value 40k
SYMBOL res -144 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL OpAmps\\ADA4625 -320 128 R0
WINDOW 3 -23 195 Left 2
SYMATTR InstName U1
SYMBOL voltage -544 208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 46 44 Left 2
WINDOW 0 38 16 Left 2
SYMATTR Value 7
SYMATTR InstName VREF
SYMBOL res -80 0 R0
SYMATTR InstName R7
SYMATTR Value 28.57k
SYMBOL nmos -112 112 R0
SYMATTR InstName M2
SYMBOL res 1536 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName ISET1
SYMATTR Value 5k
SYMBOL res 1824 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 1808 400 R90
WINDOW 0 -33 56 VBottom 2
WINDOW 3 -27 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res 1200 16 R0
SYMATTR InstName R8
SYMATTR Value 40k
SYMBOL res 1136 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL OpAmps\\ADA4625 960 128 R0
WINDOW 3 -23 195 Left 2
SYMATTR InstName U4
SYMBOL voltage 720 48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 46 44 Left 2
WINDOW 0 38 16 Left 2
SYMATTR Value 7
SYMATTR InstName VREF1
SYMBOL res 1200 256 R0
SYMATTR InstName R10
SYMATTR Value 28.57k
SYMBOL OpAmps\\LT1006 1648 192 R0
WINDOW 3 -119 -6 Left 2
SYMATTR InstName U3
SYMBOL res 1888 16 R0
SYMATTR InstName RDUT2
SYMATTR Value 2k
SYMBOL nmos 1856 240 R0
SYMATTR InstName M5
SYMBOL pmos 1168 272 M180
SYMATTR InstName M3
SYMBOL diode 1888 144 R0
SYMATTR InstName D2
TEXT -224 16 Left 2 !.tran 0.1
TEXT 224 -16 Left 2 ;sum
TEXT 1616 384 Left 2 ;sum
TEXT 704 -184 Left 2 ;The ref needs to be inverted. for everything to work with pmos,
