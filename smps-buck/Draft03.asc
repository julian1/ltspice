Version 4
SHEET 1 5720 1884
WIRE 400 -96 400 -160
WIRE 976 -96 976 -160
WIRE 1600 -80 1424 -80
WIRE 496 -16 400 -16
WIRE 1600 0 1424 0
WIRE 336 32 192 32
WIRE 976 48 976 -16
WIRE 1600 48 1600 0
WIRE 400 112 400 80
WIRE 400 112 320 112
WIRE 544 112 400 112
WIRE 688 464 640 464
WIRE 720 464 688 464
WIRE 448 496 368 496
WIRE 864 528 864 512
WIRE 864 544 864 528
WIRE 640 592 640 528
WIRE 688 592 640 592
WIRE 720 592 688 592
WIRE 48 640 -112 640
WIRE 176 656 112 656
WIRE 544 656 544 608
WIRE 544 656 176 656
WIRE 48 672 0 672
WIRE 0 704 0 672
WIRE 0 768 0 704
WIRE 304 1040 48 1040
FLAG -528 -80 0
FLAG -528 -160 VCC
FLAG 400 192 0
FLAG -704 -64 0
FLAG -704 -144 P15V
FLAG 400 -240 P15V
FLAG 544 112 IRAMP
FLAG -192 640 IRAMP
FLAG 688 464 SW
FLAG 112 672 0
FLAG 80 624 VCC
FLAG 0 848 0
FLAG 176 576 VCC
FLAG 688 592 CSW
FLAG 0 704 ISET
FLAG 976 -240 P15V
FLAG 1600 48 0
FLAG 976 112 0
FLAG 944 528 FSW
FLAG 192 32 FSW
FLAG 864 416 VCC
FLAG 864 640 0
FLAG 368 496 QRST
FLAG 80 688 0
FLAG 304 1040 QRST
FLAG 48 1120 0
FLAG 448 464 VCC
FLAG 544 384 VCC
SYMBOL voltage -528 -176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 5
SYMATTR InstName V2
SYMBOL ind2 384 -112 R0
SYMATTR InstName L1
SYMATTR Value 1m
SYMATTR Type ind
SYMBOL npn 336 -16 R0
SYMATTR InstName Q1
SYMATTR Value FJL4315
SYMBOL res 384 96 R0
SYMATTR InstName R1
SYMATTR Value 0.1R
SYMBOL ind2 1408 16 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L3
SYMATTR Value 1m
SYMATTR Type ind
SYMBOL voltage -704 -160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 15
SYMATTR InstName V4
SYMBOL res 416 -144 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 0.01R
SYMBOL res -208 656 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 85 57 VBottom 2
SYMATTR InstName R10
SYMATTR Value 10
SYMBOL res 160 560 R0
SYMATTR InstName R14
SYMATTR Value 3.3k
SYMBOL voltage 0 752 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 48 40 Left 2
SYMATTR Value 0.2
SYMATTR InstName V5
SYMBOL ind2 992 0 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 1m
SYMATTR Type ind
SYMBOL res 992 -144 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 0.01R
SYMBOL res 1584 -96 R0
SYMATTR InstName R5
SYMATTR Value 50R
SYMBOL xcomp_x11 80 592 R0
SYMATTR InstName U5
SYMATTR Value LM311
SYMBOL res 816 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL npn 800 416 R0
SYMATTR InstName Q5
SYMATTR Value 2N3904
SYMBOL diode 992 112 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL npn 800 544 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL res 816 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res 960 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 25R
SYMBOL voltage 48 1024 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -271 -43 Left 2
WINDOW 0 -23 -10 Left 2
SYMATTR Value PULSE(0 3.3 0 100n 100n 0.2ms 0.4ms 14)
SYMATTR InstName VIN1
SYMBOL 74hc74 544 384 R0
SYMATTR InstName U1
TEXT -168 -224 Left 2 !.tran 2ms
TEXT -208 -312 Left 2 !.include 74hc.lib
TEXT 1024 -456 Left 2 !K L1 L2 L3 0.99.5
TEXT -184 -368 Left 2 !.include standard.bjt
TEXT -176 -272 Left 2 !.include LM311.301
TEXT 672 864 Left 2 ;USE THE   clock input rising edge to trigger the start.\nand the ramp to reset. note async reset is active low.
TEXT 552 256 Left 2 ;THIS WORKS. WELL AS IS.
TEXT 1016 288 Left 2 ;use mic1557 to generate square wave.\n- use as current-mode  for boost/ flyback/forward. , or push pull as is.\n- for push-pull divide the square wave with another flip flop. to alternate\n- for buck, need over-the-top current sense\n- can also use another clock-divider - to get a 50% max duty. and avoid compensation\n- could also drive AB slew.
